<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GPD Portal</title>

  <!-- Font Icons & Fonts -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- Your Public CSS -->
  <link rel="stylesheet" href="/public/css_file/styles.css">
</head>

<body>
  <header class="nav">
    <div class="brand">
      <i class="fas fa-database"></i> GPD DC Portal
    </div>
    <nav class="nav-menu">
      <a data-view="home" class="nav-link active">Home</a>
      <a data-view="search-data" class="nav-link">Search Data</a>
      <a data-view="newsletter" class="nav-link">Newsletter</a>
    </nav>
    <button class="menu-toggle">
      <i class="fas fa-bars"></i>
    </button>
  </header>

  <main id="app" class="container">

    <!-- HOME VIEW -->
    <section id="home-view" class="view active">
      <section class="hero">
        <div class="hero-content">
          <h1 class="hero-title">Welcome to GPD DC Portal</h1>
          <p class="hero-subtitle">Streamlined Data Collection & Management Platform</p>
          <div class="hero-buttons">
            <button class="btn btn-primary" data-view="search-data">
              <i class="fas fa-search"></i> Search Data
            </button>
          </div>
        </div>
      </section>

      <section class="features">
        <h2 class="section-title">Key Features</h2>
        <div class="features-grid">
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-search"></i></div>
            <h3>Search Data</h3>
            <p>Find any pastor by name, designation, zone, region, chapter or group instantly.</p>
          </div>
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-image"></i></div>
            <h3>Photo Directory</h3>
            <p>View high-quality photos linked to each record.</p>
          </div>
          <div class="feature-card">
            <div class="feature-icon"><i class="fas fa-users"></i></div>
            <h3>Complete Records</h3>
            <p>All levels: Regional, Zonal, Group, Chapter & RZM pastors.</p>
          </div>
        </div>
      </section>

      <section class="stats">
        <div class="stat-item">
          <h3 class="stat-number">10K+</h3>
          <p class="stat-label">Records</p>
        </div>
        <div class="stat-item">
          <h3 class="stat-number">50+</h3>
          <p class="stat-label">Zones Covered</p>
        </div>
        <div class="stat-item">
          <h3 class="stat-number">100%</h3>
          <p class="stat-label">Accuracy</p>
        </div>
        <div class="stat-item">
          <h3 class="stat-number">24/7</h3>
          <p class="stat-label">Access</p>
        </div>
      </section>
    </section>

    <!-- SEARCH DATA VIEW -->
    <section id="search-data-view" class="view">
      <section class="dashboard-section search-dashboard">
        <div class="search-inner">
          <div class="search-box">
            <input 
              id="search-input-hero" 
              type="text" 
              class="search-input-large" 
              placeholder="Enter name, designation, zone, region, chapter or group..." 
              autocomplete="off"
            >
            <button id="search-btn-hero" class="btn btn-primary search-btn">
              <i class="fas fa-search"></i> Search Now
            </button>
          </div>
          <p style="text-align:center; margin-top:15px; color:#666;">
            Type any part of the name or title and click Search
          </p>
        </div>
      </section>

      <!-- SEARCH RESULTS WILL APPEAR HERE -->
      <div id="search-results" style="min-height:200px;"></div>
    </section>

    <!-- NEWSLETTER VIEW -->
    <section id="newsletter-view" class="view">
      <div class="page-header">
        <h1 class="page-title">
          <i class="fas fa-envelope"></i> Newsletter Management
        </h1>
        <p class="page-subtitle">Manage your newsletter subscriptions, view campaigns, and stay updated</p>
      </div>

      <!-- Newsletter Stats Section -->
      <section class="newsletter-stats">
        <div class="newsletter-stat-card">
          <div class="stat-icon-lg">
            <i class="fas fa-envelope-open"></i>
          </div>
          <div class="stat-content-lg">
            <p class="stat-label">Total Subscribers</p>
            <p class="stat-value-lg">24,563</p>
            <p class="stat-change positive"><i class="fas fa-arrow-up"></i> +12% this month</p>
          </div>
        </div>

        <div class="newsletter-stat-card">
          <div class="stat-icon-lg">
            <i class="fas fa-chart-line"></i>
          </div>
          <div class="stat-content-lg">
            <p class="stat-label">Open Rate</p>
            <p class="stat-value-lg">42.5%</p>
            <p class="stat-change positive"><i class="fas fa-arrow-up"></i> +3.2% from last issue</p>
          </div>
        </div>

        <div class="newsletter-stat-card">
          <div class="stat-icon-lg">
            <i class="fas fa-mouse-pointer"></i>
          </div>
          <div class="stat-content-lg">
            <p class="stat-label">Click Rate</p>
            <p class="stat-value-lg">18.9%</p>
            <p class="stat-change positive"><i class="fas fa-arrow-up"></i> +2.1% from last issue</p>
          </div>
        </div>

        <div class="newsletter-stat-card">
          <div class="stat-icon-lg">
            <i class="fas fa-envelope-circle-check"></i>
          </div>
          <div class="stat-content-lg">
            <p class="stat-label">Last Campaign</p>
            <p class="stat-value-lg">Dec 10</p>
            <p class="stat-change">Next scheduled: Dec 17</p>
          </div>
        </div>
      </section>

      <!-- Newsletter Subscription Section -->
      <section class="dashboard-section">
        <div class="section-header">
          <h2>Your Subscription</h2>
          
             
          
        </div>

        <div class="subscription-card">
          <div class="subscription-info">
            <h3>You are subscribed to:</h3>
            <div class="subscription-list">
              <label class="subscription-item">
                <input type="checkbox" checked>
                <div class="subscription-label">
                  <strong>Weekly News & Updates</strong>
                  <p>Get the latest news and important updates every Monday</p>
                </div>
              </label>
              <label class="subscription-item">
                <input type="checkbox" checked>
                <div class="subscription-label">
                  <strong>Monthly Reports</strong>
                  <p>Comprehensive monthly reports delivered on the first day of each month</p>
                </div>
              </label>
              <label class="subscription-item">
                <input type="checkbox">
                <div class="subscription-label">
                  <strong>Product Updates</strong>
                  <p>Stay informed about new features and product improvements</p>
                </div>
              </label>
              <label class="subscription-item">
                <input type="checkbox" checked>
                <div class="subscription-label">
                  <strong>Special Announcements</strong>
                  <p>Important announcements and critical system notifications</p>
                </div>
              </label>
            </div>
          </div>

          <div class="subscription-actions">
            <button class="btn btn-primary">
              <i class="fas fa-save"></i> Save Preferences
            </button>
            <button class="btn btn-secondary">
              <i class="fas fa-times"></i> Unsubscribe All
            </button>
          </div>
        </div>
        
      </section>

      <!-- SEARCH DATA VIEW -->
    <!-- Quick Subscribe (placed outside 'Your Subscription') -->
    <section class="newsletter-subscribe-outer">
      <div class="newsletter-subscribe-wrap">
        <form id="newsletter-subscribe-form" class="newsletter-subscribe" onsubmit="subscribeNewsletter(event)">
          <div class="form-group">
            <input id="newsletter-email" type="email" class="newsletter-email-input" placeholder="Subject line for the email" required>
          </div>
          <div class="form-actions">
            <button type="submit" class="btn btn-primary subscribe-btn"><i class="fas fa-paper-plane"></i> Subscribe</button>
          </div>
        </form>
      </div>
    </section>
    <section id="search-data-view" class="view">
      <section class="dashboard-section search-dashboard">
        <div class="search-inner">
          <div class="search-box">
            <input id="search-input-hero" type="text" class="search-input-large" placeholder=" Input word ">
            <button id="search-btn-hero" class="btn btn-primary search-btn"><i class="fas fa-search"></i> Search</button>
          </div>
        </div>
      </section>
      <!-- keep space after first container, then add white wide card -->
      <section class="wide-card-wrap">
        <div class="search-large-card">
          <div class="card-icon">
            <i class="fas fa-image"></i>
          </div>
          <h3 class="card-title">Media Search</h3>
          <p class="card-desc">Locate and manage media files with advanced search and organization tools.</p>
        </div>
      </section>
    </section>

  </main>

  <footer class="footer">
    <div class="footer-content">
      <div class="footer-section">
        <h4>GPD DC Portal</h4>
        <p>Official Directory & Data Management System</p>
      </div>
      <div class="footer-section">
        <h4>Quick Links</h4>
        <ul>
          <li><a href="#" data-view="home">Home</a></li>
          <li><a href="#" data-view="search-data">Search Records</a></li>
        </ul>
      </div>
      <div class="footer-section">
        <h4>Contact</h4>
        <p>Email: info@gpdportal.com</p>
      </div>
    </div>
    <div class="footer-bottom">
      © 2025 GPD DC Portal · All rights reserved
    </div>
  </footer>

  <!-- LIVE SEARCH SCRIPT -->
  <script>
    // Navigation between views
    document.querySelectorAll('[data-view]').forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        const view = link.getAttribute('data-view');
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(view + '-view')?.classList.add('active');
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        link.classList.add('active');
      });
    });

    // Mobile menu toggle
    document.querySelector('.menu-toggle')?.addEventListener('click', () => {
      document.querySelector('.nav-menu').classList.toggle('open');
    });

    // MAIN SEARCH FUNCTION
    document.getElementById('search-btn-hero')?.addEventListener('click', function () {
      const query = document.getElementById('search-input-hero').value.trim();
      const resultsDiv = document.getElementById('search-results');

      if (!query) {
        resultsDiv.innerHTML = `<p style="text-align:center;color:#c00;">Please enter a search term</p>`;
        return;
      }

      resultsDiv.innerHTML = `<p style="text-align:center; padding:40px; color:#003366;"><i class="fas fa-spinner fa-spin"></i> Searching...</p>`;

      fetch(`/api/search?q=${encodeURIComponent(query)}`)
        .then(res => res.json())
        .then(data => {
          resultsDiv.innerHTML = '';

          if (data.length === 0) {
            resultsDiv.innerHTML = `
              <div style="text-align:center; padding:60px; color:#666;">
                <i class="fas fa-search" style="font-size:48px; color:#ddd; margin-bottom:20px;"></i>
                <p style="font-size:1.3rem;">No results found for "<strong>${query}</strong>"</p>
              </div>`;
            return;
          }

          const grid = document.createElement('div');
          grid.style.cssText = `
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 30px;
            margin: 30px 0;
            max-width: 1200px;
            margin: 0 auto;
          `;

          data.forEach(person => {
            grid.innerHTML += `
  <div style="
    background: white;
    border-radius: 20px;
    padding: 25px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    transition: transform 0.3s;
  " onmouseover="this.style.transform='translateY(-10px)'" onmouseout="this.style.transform=''">
    <img src="${person.photo}" 
         onerror="this.src='/public/default-photo.jpg'"
         style="width:150px; height:150px; object-fit:cover; border-radius:50%; border:5px solid #003366; margin-bottom:15px;">
    <h3 style="color:#003366; margin:10px 0;">${person.name}</h3>
    <p style="margin:8px 0; color:#444;"><strong>Designation:</strong> ${person.designation || '—'}</p>
    <p style="margin:8px 0; color:#444;"><strong>KC ID:</strong> ${person.kc_id || '—'}</p>
    <p style="margin:8px 0; color:#444;"><strong>BLW Zone:</strong> ${person.blw_zone || '—'}</p>
    <p style="margin:8px 0; color:#444;"><strong>Region:</strong> ${person.region || '—'}</p>
    <p style="margin:8px 0; color:#444;"><strong>Chapter:</strong> ${person.chapter || '—'}</p>
    <p style="margin:8px 0; color:#444;"><strong>Group:</strong> ${person.group || '—'}</p>
  </div>
`;
          });

          resultsDiv.appendChild(grid);
        })
        .catch(err => {
          console.error(err);
          resultsDiv.innerHTML = `<p style="text-align:center;color:#c00;">Error loading results. Please try again.</p>`;
        });
    });

    // Optional: Press Enter to search
    document.getElementById('search-input-hero')?.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') document.getElementById('search-btn-hero').click();
    });
  </script>
</body>
</html>